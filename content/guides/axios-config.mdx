---
title: Axios
description: Axios config
date: 2024-01-23
---

```ts
import axios, { AxiosRequestConfig, AxiosError } from "axios";
import { getCustomCookie, putCustomCookie } from "./customCookies";

const isDevEnv = import.meta.env.MODE === "development";
const baseURL = import.meta.env.VITE_API_URL;

function logWarning(...text: string[]) {
  if (isDevEnv) {
    console.log(text);
  }
}
function logError(...text: string[]) {
  if (isDevEnv) {
    console.error(text);
  }
}

const instance = axios.create({
  baseURL: "https://some-domain.com/api/",
  timeout: 10000,
});

async function requestConstructor<T>(options: AxiosRequestConfig) {
  const token = getCustomCookie<string>("cookie_token");
  if (!token) {
    instance.defaults.headers.common["Authorization"] = token;
  }
  try {
    const { data: responseData } = await instance.request<T>(options);
    return { responseData, error: null };
  } catch (error) {
    if (axios.isAxiosError(error)) {
      if (error.response) {
        return {
          error: { status: error.response.status, data: error.response.data },
          data: null,
        };
      } else if (error.request) {
        return {
          error: { status: error.request.status, data: error.request.data },
          data: null,
        };
      } else {
        return { error: { status: 400, data: error.message }, data: null };
      }
    }
    console.log("Error", error?.config);
    return { data: null, error: { status: 400, data: "Nesto ne radi" } };
  }
}

  type RequestConfig = Omit<
    AxiosRequestConfig,
    "url" | "data" | "baseUrl" | "method"
  >;

  async function get<T>(url: string, config: RequestConfig = {}) {
    return requestConstructor<T>({ ...config, url, method: "get" });
  }
  async function post<T, K>(url: string, data: K, config: RequestConfig = {}) {
    return requestConstructor<T>({ ...config, url, data, method: "post" });
  }
  async function put<T, K>(url: string, data: K, config: RequestConfig = {}) {
    return requestConstructor<T>({ ...config, url, data, method: "put" });
  }
  async function remove<T, K>(url: string, data?: K, config: RequestConfig = {}) {
    return requestConstructor<T>({ ...config, url, data, method: "delete" });
  }

  const fetchData = { get, post, put, delete: remove };
```

```ts
export const getCustomCookie = <T>(name: string) => {
  const cookies = document.cookie.split(";");

  for (let i = 0; i < cookies.length; i++) {
    const cookiePair = cookies[i].split("=");
    cookiePair[0] = cookiePair[0].trim();
    if (cookiePair[0] === name) {
      try {
        return JSON.parse(cookiePair[1]) as T;
      } catch (error) {
        return cookiePair[1] as T;
      }
    }
  }
  return null;
};

export const putCustomCookie = () => {};
```

```ts title="Examples"
interface Book {
  name: string;
  author: string;
}

const books = await fetchData.get<Book[]>("/book");
const newBook = await fetchData.post<Book, Book>("/book", {
  name: "",
  author: "",
});
```